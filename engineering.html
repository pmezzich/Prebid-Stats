
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Engineering</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #072d45;
      color: white;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    h1 {
      margin-top: 30px;
    }
    .filter-bar {
      margin: 20px;
    }
    .chart-container {
      width: 90%;
      max-width: 1000px;
      margin: 40px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h1>Example Visualizations<br><em>Prebid Engineering</em></h1>
  <div class="filter-bar">
    Filter by:
    <select>
      <option>All Time</option>
      <option>Past Month</option>
      <option>Quarter</option>
      <option>Year</option>
    </select>
    <select>
      <option>All Companies</option>
    </select>
    <select>
      <option>All Names</option>
    </select>
  </div>

  <div class="chart-container">
    <canvas id="closersChart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="contributorsChart"></canvas>
  </div>
  <div class="chart-container">
    <canvas id="commentsChart"></canvas>
  </div>

  <script>
    const firebaseUrl = 'https://prebid-graphs-default-rtdb.firebaseio.com/individuals/2025-07.json';

    fetch(firebaseUrl)
      .then(response => response.json())
      .then(data => {
        if (!data) return;

        const entries = Object.entries(data);
        const closers = entries.map(([name, obj]) => [name, obj.closed || 0]).sort((a,b) => b[1]-a[1]);
        const contributors = entries.map(([name, obj]) => [name, obj.prs || 0]).sort((a,b) => b[1]-a[1]);
        const comments = entries.map(([name, obj]) => [name, obj.comments || 0]).sort((a,b) => b[1]-a[1]);

        const renderChart = (ctxId, label, values) => {
          new Chart(document.getElementById(ctxId), {
            type: 'bar',
            data: {
              labels: values.map(e => e[0]),
              datasets: [{
                label,
                data: values.map(e => e[1]),
                backgroundColor: '#f47c2c'
              }]
            },
            options: {
              responsive: true,
              indexAxis: 'y',
              plugins: {
                legend: { display: false },
                title: {
                  display: true,
                  text: label,
                  color: 'black',
                  font: { size: 18 }
                }
              },
              scales: {
                x: { ticks: { color: 'black' }, grid: { color: '#ccc' } },
                y: { ticks: { color: 'black' }, grid: { color: '#ccc' } }
              }
            }
          });
        };

        renderChart('closersChart', 'Top Closers', closers.slice(0, 15));
        renderChart('contributorsChart', 'Top Contributors', contributors.slice(0, 15));
        renderChart('commentsChart', 'Top by Comments', comments.slice(0, 15));
      });
  </script>
</body>
</html>
